# üõ°Ô∏è –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∑–∞—â–∏—Ç–µ –æ—Ç —Å–ø–∞–º–∞

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∑–∞—â–∏—Ç—ã

### 1. Honeypot –ø–æ–ª—è

**–ß—Ç–æ —ç—Ç–æ:** –°–∫—Ä—ã—Ç—ã–µ –ø–æ–ª—è –≤ —Ñ–æ—Ä–º–∞—Ö, –∫–æ—Ç–æ—Ä—ã–µ –∑–∞–ø–æ–ª–Ω—è—é—Ç —Ç–æ–ª—å–∫–æ –±–æ—Ç—ã.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- –î–æ–±–∞–≤–ª–µ–Ω—ã honeypot –ø–æ–ª—è –≤–æ –≤—Å–µ —Ñ–æ—Ä–º—ã (`index.html`, `gov-customers.html`)
- –ü–æ–ª—è —Å–∫—Ä—ã—Ç—ã —á–µ—Ä–µ–∑ CSS (`display:none`, `visibility:hidden`)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ `telegram.php` - –µ—Å–ª–∏ –ø–æ–ª–µ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ, –∑–∞–ø—Ä–æ—Å –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è

**–§–∞–π–ª—ã:**
- `index.html` - —Ñ–æ—Ä–º—ã –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏ –∏ –æ–±—Ä–∞—Ç–Ω–æ–≥–æ –∑–≤–æ–Ω–∫–∞
- `gov-customers.html` - —Ñ–æ—Ä–º–∞ –∑–∞–ø—Ä–æ—Å–∞ –ö–ü
- `telegram.php` - –ø—Ä–æ–≤–µ—Ä–∫–∞ honeypot –ø–æ–ª—è

---

### 2. Rate Limiting (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —á–∞—Å—Ç–æ—Ç—ã –∑–∞–ø—Ä–æ—Å–æ–≤)

**–ß—Ç–æ —ç—Ç–æ:** –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ —Å –æ–¥–Ω–æ–≥–æ IP –∑–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–µ –≤—Ä–µ–º—è.

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è PHP —Å–µ—Å—Å–∏–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –∑–∞–ø—Ä–æ—Å–∞
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏: 10 —Å–µ–∫—É–Ω–¥
- –ü—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ª–∏–º–∏—Ç–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –æ—à–∏–±–∫–∞ 429 (Too Many Requests)

**–ö–æ–¥ –≤ `telegram.php`:**
```php
session_start();
$last_submit_time = $_SESSION['last_form_submit'] ?? 0;
$current_time = time();

if ($current_time - $last_submit_time < 10) {
    http_response_code(429);
    die('Too many requests. Please wait a moment.');
}

$_SESSION['last_form_submit'] = $current_time;
```

---

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã –∑–∞—â–∏—Ç—ã (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å)

### 3. Google reCAPTCHA v3 (–Ω–µ–≤–∏–¥–∏–º–∞—è)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ù–µ–≤–∏–¥–∏–º–∞—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –û—Ü–µ–Ω–∫–∞ —Ä–∏—Å–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏–π –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å:**

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–∞ https://www.google.com/recaptcha/admin
2. –°–æ–∑–¥–∞—Ç—å —Å–∞–π—Ç, –≤—ã–±—Ä–∞—Ç—å reCAPTCHA v3
3. –ü–æ–ª—É—á–∏—Ç—å Site Key –∏ Secret Key

**–î–æ–±–∞–≤–∏—Ç—å –≤ HTML (–ø–µ—Ä–µ–¥ –∑–∞–∫—Ä—ã–≤–∞—é—â–∏–º `</head>`):**
```html
<script src="https://www.google.com/recaptcha/api.js?render=YOUR_SITE_KEY"></script>
```

**–î–æ–±–∞–≤–∏—Ç—å –≤ —Ñ–æ—Ä–º—ã (–ø–µ—Ä–µ–¥ –æ—Ç–ø—Ä–∞–≤–∫–æ–π):**
```javascript
grecaptcha.ready(function() {
    grecaptcha.execute('YOUR_SITE_KEY', {action: 'submit'}).then(function(token) {
        // –î–æ–±–∞–≤–∏—Ç—å token –≤ —Ñ–æ—Ä–º—É –∫–∞–∫ —Å–∫—Ä—ã—Ç–æ–µ –ø–æ–ª–µ
        const tokenInput = document.createElement('input');
        tokenInput.type = 'hidden';
        tokenInput.name = 'recaptcha_token';
        tokenInput.value = token;
        form.appendChild(tokenInput);
    });
});
```

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ PHP:**
```php
$recaptcha_token = $_POST['recaptcha_token'] ?? '';
$secret_key = 'YOUR_SECRET_KEY';
$verify_url = "https://www.google.com/recaptcha/api/siteverify?secret={$secret_key}&response={$recaptcha_token}";
$response = json_decode(file_get_contents($verify_url));

if (!$response->success || $response->score < 0.5) {
    http_response_code(403);
    die('Spam detected');
}
```

---

### 4. –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:** –ß–∞—Å—Ç–∏—á–Ω–∞—è (–≤ `telegram.php`)

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–æ–±–∞–≤–∏—Ç—å:**

```php
// –ü—Ä–æ–≤–µ—Ä–∫–∞ email
if (!filter_var($email, FILTER_VALIDATE_EMAIL)) {
    http_response_code(400);
    die('Invalid email');
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ (—Ä–æ—Å—Å–∏–π—Å–∫–∏–π —Ñ–æ—Ä–º–∞—Ç)
if (!preg_match('/^\+7\s?\(\d{3}\)\s?\d{3}-\d{2}-\d{2}$/', $phone)) {
    http_response_code(400);
    die('Invalid phone format');
}

// –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏—è
if (strlen($message) > 5000) {
    http_response_code(400);
    die('Message too long');
}
```

---

### 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ IP –∞–¥—Ä–µ—Å–æ–≤ (—á–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫)

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

```php
// –°–ø–∏—Å–æ–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö IP
$blocked_ips = [
    '123.456.789.0',
    '111.222.333.444'
];

$user_ip = $_SERVER['REMOTE_ADDR'] ?? '';

if (in_array($user_ip, $blocked_ips)) {
    http_response_code(403);
    die('Access denied');
}
```

---

### 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ User-Agent

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

```php
$user_agent = $_SERVER['HTTP_USER_AGENT'] ?? '';

// –ë–ª–æ–∫–∏—Ä—É–µ–º –∑–∞–ø—Ä–æ—Å—ã –±–µ–∑ User-Agent –∏–ª–∏ —Å –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏
if (empty($user_agent) || 
    preg_match('/bot|crawler|spider|scraper/i', $user_agent)) {
    // –ú–æ–∂–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å, –Ω–æ –Ω–µ –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é
    // (–Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ª–µ–≥–∏—Ç–∏–º–Ω—ã–µ –±–æ—Ç—ã –º–æ–≥—É—Ç –∏–º–µ—Ç—å —Ç–∞–∫–∏–µ User-Agent)
}
```

---

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–ø–∞–º–∞

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

**–î–æ–±–∞–≤–∏—Ç—å –≤ `telegram.php`:**

```php
// –§—É–Ω–∫—Ü–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
function logSuspiciousRequest($reason, $data) {
    $log_file = __DIR__ . '/spam_log.txt';
    $log_entry = date('Y-m-d H:i:s') . " - $reason\n";
    $log_entry .= "IP: " . ($_SERVER['REMOTE_ADDR'] ?? 'unknown') . "\n";
    $log_entry .= "Data: " . json_encode($data) . "\n\n";
    file_put_contents($log_file, $log_entry, FILE_APPEND);
}

// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
if (!empty($_POST['website'])) {
    logSuspiciousRequest('Honeypot filled', $_POST);
    http_response_code(403);
    die('Spam detected');
}
```

---

## ‚úÖ –ß–µ–∫-–ª–∏—Å—Ç –∑–∞—â–∏—Ç—ã –æ—Ç —Å–ø–∞–º–∞

- [x] Honeypot –ø–æ–ª—è –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤–æ –≤—Å–µ —Ñ–æ—Ä–º—ã
- [x] Rate limiting —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω (10 —Å–µ–∫—É–Ω–¥ –º–µ–∂–¥—É –∑–∞–ø—Ä–æ—Å–∞–º–∏)
- [x] –ü—Ä–æ–≤–µ—Ä–∫–∞ honeypot –≤ PHP
- [ ] Google reCAPTCHA v3 (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
- [ ] –†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- [ ] –ß–µ—Ä–Ω—ã–π —Å–ø–∏—Å–æ–∫ IP (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

---

## üéØ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∑–∞—â–∏—Ç—ã

### –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (honeypot + rate limiting):
- **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:** ~85-90% –ø—Ä–æ—Ç–∏–≤ –ø—Ä–æ—Å—Ç—ã—Ö –±–æ—Ç–æ–≤
- **–ó–∞—â–∏—Ç–∞ –æ—Ç:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –±–æ—Ç–æ–≤, –ø—Ä–æ—Å—Ç—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤

### –° –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º reCAPTCHA v3:
- **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:** ~95-98% –ø—Ä–æ—Ç–∏–≤ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ —Å–ø–∞–º–∞
- **–ó–∞—â–∏—Ç–∞ –æ—Ç:** –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã—Ö –±–æ—Ç–æ–≤, –º–∞—Å—Å–æ–≤—ã—Ö —Ä–∞—Å—Å—ã–ª–æ–∫

---

## üìù –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:** –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ –ª–æ–≥–∏ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
2. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–ª—è–π—Ç–µ –º–µ—Ç–æ–¥—ã –∑–∞—â–∏—Ç—ã –ø–æ –º–µ—Ä–µ –ø–æ—è–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —É–≥—Ä–æ–∑
3. **–ë–∞–ª–∞–Ω—Å:** –ù–µ –¥–µ–ª–∞–π—Ç–µ –∑–∞—â–∏—Ç—É —Å–ª–∏—à–∫–æ–º —Å—Ç—Ä–æ–≥–æ–π - —ç—Ç–æ –º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ª–µ–≥–∏—Ç–∏–º–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
4. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –†–µ–≥—É–ª—è—Ä–Ω–æ —Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ —Ñ–æ—Ä–º—ã –Ω–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å

---

## üîç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞—â–∏—Ç—ã

### –ü—Ä–æ–≤–µ—Ä–∫–∞ honeypot:
1. –û—Ç–∫—Ä—ã—Ç—å —Ñ–æ—Ä–º—É –≤ –±—Ä–∞—É–∑–µ—Ä–µ
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ honeypot –ø–æ–ª–µ –Ω–µ–≤–∏–¥–∏–º–æ (DevTools ‚Üí Elements)
3. –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –∑–∞–ø–æ–ª–Ω–∏—Ç—å honeypot –ø–æ–ª–µ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å:
   ```javascript
   document.querySelector('input[name="website"]').value = 'test';
   ```
4. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ä–º—É - –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ rate limiting:
1. –û—Ç–ø—Ä–∞–≤–∏—Ç—å —Ñ–æ—Ä–º—É
2. –°—Ä–∞–∑—É –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –µ—â–µ —Ä–∞–∑ (–≤ —Ç–µ—á–µ–Ω–∏–µ 10 —Å–µ–∫—É–Ω–¥)
3. –í—Ç–æ—Ä–∞—è –æ—Ç–ø—Ä–∞–≤–∫–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ë–∞–∑–æ–≤–∞—è –∑–∞—â–∏—Ç–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å reCAPTCHA v3 –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∑–∞—â–∏—Ç—ã
